<!DOCTYPE html>
<html lang="en" xmlns:th="http://www/thymeleaf.org">
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<meta http-equiv="X-UA-Compatible" content="ie=edge">
		<title>主页管理</title>
		<link rel="stylesheet" th:href="@{/css/fontawesome.min.css}">
		<link rel="stylesheet" th:href="@{/css/bootstrap.min.css}">
		<link rel="stylesheet" th:href="@{/css/templatemo-style.css}">
	</head>
	<body id="reportsPage">
		<div class="" id="home">
			<div class="container">
				<div class="row">
					<div class="col">
						<p class="text-white mt-5 mb-5">Welcome back, <b th:text="${session.staff.user.uname}" th:if="${session.staff!=null}"></b></p>
					</div>
				</div>
				<!-- row -->
				<div class="row tm-content-row">
	
					<div class="col-sm-12 col-md-12 col-lg-6 col-xl-6 tm-block-col">
						<div class="tm-bg-primary-dark tm-block tm-block-taller">
							<h2 class="tm-block-title">项目选购图</h2>
							<div id="pieChartContainer">
								<canvas id="pieChart" class="chartjs-render-monitor" width="200" height="200"></canvas>
							</div>
						</div>
					</div>

					<div class="col-sm-12 col-md-12 col-lg-6 col-xl-6 tm-block-col">
						<div class="tm-bg-primary-dark tm-block tm-block-taller">
							<h2 class="tm-block-title">餐饮选购图</h2>
							<div id="pieChartContainer1">
								<canvas id="pieChart1" class="chartjs-render-monitor" width="200" height="200"></canvas>
							</div>
						</div>
					</div>
					<div class="col-sm-12 col-md-12 col-lg-6 col-xl-6 tm-block-col">
						<div class="tm-bg-primary-dark tm-block tm-block-taller">
							<h2 class="tm-block-title">酒店选购图</h2>
							<div id="pieChartContainer2">
								<canvas id="pieChart2" class="chartjs-render-monitor" width="200" height="200"></canvas>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div style="height: 240px;">
				
			</div>
		</div>
		<script th:src="@{/js/jquery-3.3.1.min.js}"></script>
		<script th:src="@{/js/moment.min.js}"></script>
		<script th:src="@{/js/Chart.min.js}"></script>
		<script th:src="@{/js/bootstrap.min.js}"></script>
		<script th:src="@{/js/tooplate-scripts-cy.js}"></script>
		<script th:inline="javascript">
			function getColor() {
		    return (function(m, s, c) {
		        return (c ? arguments.callee(m, s, c - 1) : '#') +
		            s[m.floor(m.random() * 16)]
		    })(Math, '0123456789abcdef', 5)
			}
			Chart.defaults.global.defaultFontColor = 'white';
			
			 
			var newpielable=[]
			var newpiedatasets =[]
			var s={};
			var data=[];
			var backgroundColor=[];
			$.each([[${listp}]],function(index,item){
				data.push(item.countnum);
				backgroundColor.push(getColor());
				newpielable.push(item.pname+"("+item.countnum+")");
			})
			s.data=data;
			s.label="Storage";
			s.backgroundColor=backgroundColor;
			newpiedatasets.push(s);
			var newpielable1 =[]
			var newpiedatasets1 = [];
			s={};
			data=[];
			backgroundColor=[];
			$.each([[${listm}]],function(index,item){
				data.push(item.countnum);
				backgroundColor.push(getColor());
				newpielable1.push(item.mname+"("+item.countnum+")");
			})
			s.data=data;
			s.label="Storage";
			s.backgroundColor=backgroundColor;
			newpiedatasets1.push(s);
			 var newpielable2 = [];
			var newpiedatasets2 = [];
			s={};
			data=[];
			backgroundColor=[];
			$.each([[${listr}]],function(index,item){
				data.push(item.countnum);
				backgroundColor.push(getColor());
				newpielable2.push(item.rname+"("+item.countnum+")");
			})
			s.data=data;
			s.label="Storage";
			s.backgroundColor=backgroundColor;
			newpiedatasets2.push(s); 
			let ctxLine,
				ctxBar,
				ctxPie,
				optionsLine,
				optionsBar,
				optionsPie,
				newLine,
				configBar,
				configPie,
				 pieChart;
			// DOM is ready
			$(function() {
				var barname = "barChart";
				var barname1="Food1";
				var barname2="Hotel";			
				var piechart = "pieChart";
				var piechart1="pieChart1"
				var piechart2="pieChart2";
				var piecontainer = "pieChartContainer";
				var piecontainer1="pieChartContainer1";
				var piecontainer2="pieChartContainer2";
/* 				drawBarChart(bartitle,newbarlables, newbardatasets, barname); // Bar Chart
 */				drawPieChart(newpielable, newpiedatasets, piechart, piecontainer); // Pie Chart
/* 				drawBarChart(bartitle1,newbarlables1,newbardatasets1,barname1);
 */				drawPieChart(newpielable1,newpiedatasets1,piechart1,piecontainer1);
/* 				drawBarChart(bartitle2,newbarlables2,newbardatasets2,barname2)
 */				drawPieChart(newpielable2,newpiedatasets2,piechart2,piecontainer2);
				$(window).resize(function() {
					updateLineChart();
					updateBarChart();
				});
			})
		</script>
	</body>
</html>
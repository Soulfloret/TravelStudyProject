<!DOCTYPE html>
<html lang="en" xmlns="http://www.themleaf.org">
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<meta http-equiv="X-UA-Compatible" content="ie=edge">
		<title>主页管理</title>
		<link rel="stylesheet" th:href="@{/css/fontawesome.min.css}">
		<link rel="stylesheet" th:href="@{/css/bootstrap.min.css}">
		<link rel="stylesheet" th:href="@{/css/templatemo-style.css}">
	</head>
	<body id="reportsPage">
		<div class="" id="home">
			<nav class="navbar navbar-expand-xl">
				<div class="container h-100">
					<a class="navbar-brand" href="index.html" target="main">
						<h1 class="tm-site-title mb-0">研学旅行</h1>
					</a>
					<button class="navbar-toggler ml-auto mr-0" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                    <i class="fas fa-bars tm-nav-icon"></i>
                </button>
					<div class="collapse navbar-collapse" id="navbarSupportedContent">
						<ul class="navbar-nav mx-auto h-100">
						</ul>
						<ul class="navbar-nav">
							<li class="nav-item">
								<a class="nav-link d-block" href="login.html" target="main">
									Admin, <b>Logout</b>
								</a>
							</li>
						</ul>
					</div>
				</div>
			</nav>
			<iframe scrolling="no" id="main" name="main" frameborder="0"  style="min-height:600px;width:100%;height:100%;" src="index.html"></iframe>
			<footer class="tm-footer row tm-mt-small">
				<div class="col-12 font-weight-light">
					<p class="text-center text-white mb-0 px-4 small">
						Copyright &copy; <b>2018</b> 
					</p>
				</div>
			</footer>
		</div>
		<script th:src="@{/js/jquery-3.3.1.min.js}"></script>
		<script th:src="@{/js/moment.min.js}"></script>
		<script th:src="@{/js/Chart.min.js}"></script>
		<script th:src="@{/js/bootstrap.min.js}"></script>
		<script th:src="@{/js/tooplate-scripts-cy.js}"></script>
		<script th:line="javascript" >
		$.post("/module/queryByUid",function(data){
			console.log(data);
			 $.each(data,function(index,item){
				 var li;
				 if(item.url==null||item.url==""){
					li=$("<li class='nav-item dropdown'>"
						+"<a class='nav-link dropdown-toggle' id='navbarDropdown' href='#' role='button' data-toggle='dropdown' aria-haspopup='true' aria-expanded='false'>"
						+"<i class='fas fa-shopping-cart'></i>"
						+"<span>"
                       	+""+item.mname+"<i class='fas fa-angle-down'></i>"
                       	+"</span>"
						+"</a>"
						+"</li>");
					var div=$("<div class='dropdown-menu' aria-labelledby='navbarDropdown'></div>");
					$.each(item.mlist,function(index1,item1){
						var a=$("<a class='dropdown-item' href='/"+item1.url+"' target='main'>"+item1.mname+"</a>")
						div.append(a);
						if(index1==0&&index==0){
							$("#main").attr("src",item1.url);
						}
					})
					li.append(div);
				 }else{
					li=$("<li class='nav-item'>"
						+"<a class='nav-link' href='/"+item.url+"' target='main'>"
						+"<i class='fa fa-bars'></i>"+item.mname+""
						+"</a>"
						+"</li>");
					$("#main").attr("src",item.url);
				 }
				 $(".mx-auto").append(li);
			 })
		},"json")
		  // 计算页面的实际高度，iframe自适应会用到
		  function calcPageHeight(doc) {
		      var cHeight = Math.max(doc.body.clientHeight, doc.documentElement.clientHeight)
		      var sHeight = Math.max(doc.body.scrollHeight, doc.documentElement.scrollHeight)
		      var height  = Math.max(cHeight, sHeight)
		      return height
		  }
		  //根据ID获取iframe对象
		  var ifr = document.getElementById('main')
		  ifr.onload = function() {
		  	  //解决打开高度太高的页面后再打开高度较小页面滚动条不收缩
		  	  ifr.style.height='0px';
		      var iDoc = ifr.contentDocument || ifr.document
		      var height = calcPageHeight(iDoc)
		      if(height < 850){
		      	height = 850;
		      }
		      ifr.style.height = height + 'px'
		  }
	</script>
	</body>
</html>